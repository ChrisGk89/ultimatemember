var um_members_layout=[],um_members_last_data=[],um_members_hash_data={},um_members_directory_busy=[];function is_directory_busy(e){return void 0!==um_members_directory_busy[um_members_get_unique_id(e)]&&um_members_directory_busy[um_members_get_unique_id(e)]}function um_members_set_layout(e,r){um_members_layout[um_members_get_unique_id(e)]=r,e.data("view_type",r)}function um_members_get_layout(e){return um_members_layout[um_members_get_unique_id(e)]}function um_members_set_last_data(e,r){um_members_last_data[um_members_get_unique_id(e)]=r}function um_members_get_last_data(e){return um_members_last_data[um_members_get_unique_id(e)]}function um_members_get_unique_id(e){return e.data("unique_id")}function um_members_get_page(e){return e.data("page")}function um_members_set_page(e,r){return e.data("page",r)}function um_members_set_search(e){e.find(".um-search-line").val(um_members_hash_data[um_members_get_unique_id(e)].general_search)}function um_members_set_sorting(e){e.find(".um-member-directory-sorting-options").val(um_members_hash_data[um_members_get_unique_id(e)].sorting).trigger("change")}function um_members_set_filters(e){if(!jQuery("#tmpl-um-members-filtered-line").length)return!1;var u=um_members_get_unique_id(e),i=[];e.find(".um-search-filter").each(function(){var r,m=jQuery(this).find("select").attr("name"),a=um_members_hash_data[u][m],t=jQuery(this).find("select").data("placeholder"),s=jQuery(this);if(void 0!==a&&("string"==typeof a?(r=s.find('select option[value="'+a+'"]').data("value_label"),i.push({name:m,label:t,value_label:r,value:a,unique_id:u})):jQuery.each(a,function(e){r=s.find('select option[value="'+a[e]+'"]').data("value_label"),i.push({name:m,label:t,value_label:r,value:a[e],unique_id:u})})),jQuery(this).find(".um-slider")){var e=um_members_hash_data[u].birth_date;void 0!==e&&(jQuery(this).find(".um-slider").slider("option","values",e),jQuery(this).find(".um_range_min").val(e[0]),jQuery(this).find(".um_range_max").val(e[1]),jQuery(this).find(".um-slider-range").html(jQuery(this).find(".um-slider").slider("values",0)+" - "+jQuery(this).find(".um-slider").slider("values",1)+" y.o"))}}),e.find(".um-members-filter-tag").remove();var r=wp.template("um-members-filtered-line");e.find(".um-filtered-line").prepend(r({filters:i})),0<i.length?e.find(".um-filtered-line").show():e.find(".um-filtered-line").hide()}function um_members_show_preloader(e){e.find(".um-members-overlay").show()}function um_members_hide_preloader(e){e.find(".um-members-overlay").hide()}function um_ajax_get_members(m){var e=um_members_parse_hash(m);e.args=um_members_args,e.nonce=um_scripts.nonce,e.referrer_url=window.location.href,wp.ajax.send("um_get_members",{data:e,success:function(e){um_members_set_last_data(m,e),um_build_template(m,e),um_members_hide_preloader(m);var r=wp.template("um-members-pagination");m.find(".um-members-pagination-box").html(r(e)),m.data("total_pages",e.pagi.total_pages),um_members_directory_busy[um_members_get_unique_id(m)]=!1},error:function(e){console.log(e)}})}function um_build_template(e,r){var m=um_members_get_layout(e),a=wp.template("um-member-"+m);e.find(".um-members-grid, .um-members-list").remove(),e.find(".um-members-wrapper").prepend(a(r)),e.addClass("um-loaded"),e.find(".um-members").length&&(UM_Member_Grid(e.find(".um-members")),jQuery(window).trigger("resize")),jQuery(document.body).trigger("um_build_template",[e])}function um_members_create_hash_string(){var e=[];for(var r in um_members_hash_data)for(var m in um_members_hash_data[r])e.push(m+"_"+r+"="+um_members_hash_data[r][m]);return e.length?"#"+jQuery.base64Encode(e.join("&")):""}function um_members_parse_hash(e){var r={},m=window.location.hash.substring(1,window.location.hash.length);if(""==m)return r;var a=um_members_get_unique_id(e),t=(m=jQuery.base64Decode(m)).split("&");for(var s in t){var u=t[s].split("=");-1!==u[0].search(new RegExp("_"+a+"$","g"))&&(u[0]=u[0].replace(new RegExp("_"+a+"$","g"),""),-1!==u[1].search(new RegExp(",","g"))?r[u[0]]=u[1].split(","):r[u[0]]=u[1])}return r}function um_members_set_hash(e){um_members_hash_data[um_members_get_unique_id(e)]=um_members_parse_hash(e)}function um_members_clear_hash(e){jQuery.each(um_members_hash_data,function(r){jQuery('.um-directory[data-unique_id="'+r+'"]').length?jQuery.each(um_members_hash_data[r],function(e){""==um_members_hash_data[r][e]&&delete um_members_hash_data[r][e]}):delete um_members_hash_data[r]}),e&&(unique_table=!1,window.location.hash=um_members_create_hash_string())}function um_members_directory_loop(){jQuery(".um-directory").each(function(){if(um_members_directory_busy[um_members_get_unique_id(jQuery(this))]=!0,um_members_set_layout(jQuery(this),jQuery(this).data("view_type")),um_members_set_hash(jQuery(this)),um_members_set_search(jQuery(this)),um_members_set_sorting(jQuery(this)),um_members_set_filters(jQuery(this)),"1"==jQuery(this).data("only_search")&&!um_members_hash_data[um_members_get_unique_id(jQuery(this))].hasOwnProperty("general_search"))return um_members_hide_preloader(jQuery(this)),um_members_directory_busy[um_members_get_unique_id(jQuery(this))]=!1;um_members_show_preloader(jQuery(this)),um_ajax_get_members(jQuery(this))})}function UM_Member_Grid(e){e.find(".um-member").length&&e.imagesLoaded(function(){e.masonry({itemSelector:".um-member",columnWidth:".um-member",gutter:".um-gutter-sizer"})})}jQuery(document).ready(function(){jQuery(document.body).on("click",".um-member-directory-view-type-a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var m=um_members_get_layout(r);um_members_set_layout(r,m="grid"==m?"list":"grid");var a="list"==m?"um-faicon-list":"um-faicon-th";r.find(".um-member-directory-view-type-a i").attr("class",a);var t="list"==m?"Change to Grid":"Change to List";r.find(".um-member-directory-view-type-a").attr("original-title",t),r.find(".um-member-directory-view-type-a").tipsy("hide").tipsy("show");var s=um_members_get_last_data(r);void 0!==s?um_build_template(r,s):(um_members_show_preloader(r),um_ajax_get_members(r))}),jQuery(document.body).on("click",".um-directory .pagi:not(.current)",function(e){if(e.preventDefault(),!jQuery(this).hasClass("disabled")){var r,m=jQuery(this).parents(".um-directory");return is_directory_busy(m)||(1==(r="first"==jQuery(this).data("page")?1:"prev"==jQuery(this).data("page")?1*m.data("page")-1:"next"==jQuery(this).data("page")?1*m.data("page")+1:"last"==jQuery(this).data("page")?m.data("total_pages"):jQuery(this).data("page"))?(m.find('.pagi[data-page="first"], .pagi[data-page="prev"]').addClass("disabled"),m.find('.pagi[data-page="prev"], .pagi[data-page="last"]').removeClass("disabled")):(r==m.data("total_pages")?m.find('.pagi[data-page="prev"], .pagi[data-page="last"]').addClass("disabled"):m.find('.pagi[data-page="prev"], .pagi[data-page="last"]').removeClass("disabled"),m.find('.pagi[data-page="first"], .pagi[data-page="prev"]').removeClass("disabled")),m.find(".pagi").removeClass("current"),m.find('.pagi[data-page="'+r+'"]').addClass("current"),um_members_set_page(m,r),um_members_hash_data[um_members_get_unique_id(m)].page=r,window.location.hash=um_members_create_hash_string()),!1}}),jQuery(document.body).on("change",".um-directory .um-members-pagi-dropdown",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var m=jQuery(this).val();return r.find(".pagi").removeClass("current"),r.find('.pagi[data-page="'+m+'"]').addClass("current"),um_members_set_page(r,m),um_members_hash_data[um_members_get_unique_id(r)].page=m,window.location.hash=um_members_create_hash_string(),!1}),jQuery(document.body).on("click",".um-do-search",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var m=um_members_get_unique_id(r);return um_members_hash_data[m].general_search=r.find(".um-search-line").val(),um_members_hash_data[m].page="",um_members_clear_hash(),window.location.hash=um_members_create_hash_string(),!1}),jQuery(document.body).on("keypress",".um-search-line",function(e){"13"==e.which&&jQuery(this).parents(".um-directory").find(".um-do-search").trigger("click")}),jQuery(".um-member-directory-filters").click(function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory").find(".um-search");r.is(":visible")?r.slideUp(750):r.slideDown(750)}),jQuery(".um-close-filter").click(function(e){e.preventDefault(),jQuery(this).parents(".um-directory").find(".um-search").slideUp(750)}),jQuery(document.body).on("change",".um-search-filter select",function(e){if(e.preventDefault(),""==jQuery(this).val())return!1;var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var m=um_members_get_unique_id(r),a=um_members_hash_data[m][jQuery(this).prop("name")];return void 0===a?a=[]:"string"==typeof a&&(a=[a]),-1==jQuery.inArray(jQuery(this).val(),a)&&(a.push(jQuery(this).val()),um_members_hash_data[m][jQuery(this).prop("name")]=a,um_members_hash_data[m].page=1,um_members_clear_hash(),window.location.hash=um_members_create_hash_string()),jQuery(this).val("").trigger("change"),!1}),jQuery(document.body).on("click",".um-members-filter-remove",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var m=um_members_get_unique_id(r),a=jQuery(this).data("value");return"string"==typeof um_members_hash_data[m][jQuery(this).data("name")]&&(um_members_hash_data[m][jQuery(this).data("name")]=[um_members_hash_data[m][jQuery(this).data("name")]]),um_members_hash_data[m][jQuery(this).data("name")]=jQuery.grep(um_members_hash_data[m][jQuery(this).data("name")],function(e){return e!=a}),um_members_hash_data[m].page=1,um_members_clear_hash(),r.find(".um-members-filter-tag").remove(),window.location.hash=um_members_create_hash_string(),!1}),jQuery(document.body).on("click",".um-clear-filters-a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var m=um_members_get_unique_id(r);return r.find(".um-members-filter-remove").each(function(){var r=jQuery(this).data("value");"string"==typeof um_members_hash_data[m][jQuery(this).data("name")]&&(um_members_hash_data[m][jQuery(this).data("name")]=[um_members_hash_data[m][jQuery(this).data("name")]]),um_members_hash_data[m][jQuery(this).data("name")]=jQuery.grep(um_members_hash_data[m][jQuery(this).data("name")],function(e){return e!=r})}),um_members_hash_data[m].page=1,r.find(".um-members-filter-tag").remove(),um_members_clear_hash(),window.location.hash=um_members_create_hash_string(),!1});var e=jQuery(".um-slider");jQuery(".um-slider").slider({range:!0,min:parseInt(e.data("min")),max:parseInt(e.data("max")),values:[parseInt(e.data("min")),parseInt(e.data("max"))],create:function(e,r){console.log(r)},slide:function(e,r){jQuery(this).siblings(".um-slider-range").html(r.values[0]+" - "+r.values[1]+" y.o"),jQuery(this).siblings(".um_range_min").val(r.values[0]),jQuery(this).siblings(".um_range_max").val(r.values[1])},stop:function(e,r){var m=jQuery(this).parents(".um-directory"),a=um_members_get_unique_id(m);is_directory_busy(m)||(um_members_hash_data[a][jQuery(this).data("field_name")]=r.values,um_members_hash_data[a].page=1,um_members_clear_hash(),window.location.hash=um_members_create_hash_string())}}),jQuery(".um-slider-range").each(function(){jQuery(this).html(jQuery(this).siblings(".um-slider").slider("values",0)+" - "+jQuery(this).siblings(".um-slider").slider("values",1)+" y.o"),jQuery(this).siblings(".um_range_min").val(jQuery(this).siblings(".um-slider").slider("values",0)),jQuery(this).siblings(".um_range_max").val(jQuery(this).siblings(".um-slider").slider("values",1))}),jQuery(document.body).on("change",".um-member-directory-sorting-options",function(e){var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var m=um_members_get_unique_id(r);return um_members_hash_data[m].sorting=jQuery(this).val(),um_members_hash_data[m].page=1,window.location.hash=um_members_create_hash_string(),!1}),jQuery(document.body).on("click",".um-member-more a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory"),m=jQuery(this).parents(".um-member");m.find(".um-member-more").hide(),m.find(".um-member-meta").slideDown(function(){m.find(".um-member-less").fadeIn(),r.find(".um-members").length&&UM_Member_Grid(r.find(".um-members"))}),setTimeout(function(){r.find(".um-members").length&&UM_Member_Grid(r.find(".um-members"))},100)}),jQuery(document).on("click",".um-member-less a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory"),m=jQuery(this).parents(".um-member");m.find(".um-member-less").hide(),m.find(".um-member-meta").slideUp(function(){m.find(".um-member-more").fadeIn(),r.find(".um-members").length&&UM_Member_Grid(r.find(".um-members"))})}),window.addEventListener("popstate",function(e){um_members_directory_loop()}),um_members_directory_loop()});