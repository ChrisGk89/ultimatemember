function is_directory_busy(e){return"undefined"!=typeof um_members_directory_busy[um_members_get_unique_id(e)]&&um_members_directory_busy[um_members_get_unique_id(e)]}function um_members_set_layout(e,r){um_members_layout[um_members_get_unique_id(e)]=r,e.data("view_type",r)}function um_members_get_layout(e){return um_members_layout[um_members_get_unique_id(e)]}function um_members_set_last_data(e,r){um_members_last_data[um_members_get_unique_id(e)]=r}function um_members_get_last_data(e){return um_members_last_data[um_members_get_unique_id(e)]}function um_members_get_unique_id(e){return e.data("unique_id")}function um_members_get_page(e){return e.data("page")}function um_members_set_page(e,r){return e.data("page",r)}function um_members_set_search(e){e.find(".um-search-line").val(um_members_hash_data[um_members_get_unique_id(e)].general_search)}function um_members_set_sorting(e){e.find(".um-member-directory-sorting-options").val(um_members_hash_data[um_members_get_unique_id(e)].sorting).trigger("change")}function um_members_set_filters(e){if(!jQuery("#tmpl-um-members-filtered-line").length)return!1;var r=um_members_get_unique_id(e),a=[];e.find(".um-search-filter").each(function(){var e,m=jQuery(this).find("select").attr("name"),t=um_members_hash_data[r][m],s=jQuery(this).find("select").data("placeholder"),u=jQuery(this);if("undefined"!=typeof t&&("string"==typeof t?(e=u.find('select option[value="'+t+'"]').data("value_label"),a.push({name:m,label:s,value_label:e,value:t,unique_id:r})):jQuery.each(t,function(i){e=u.find('select option[value="'+t[i]+'"]').data("value_label"),a.push({name:m,label:s,value_label:e,value:t[i],unique_id:r})})),jQuery(this).find(".um-slider")){var i=um_members_hash_data[r].birth_date;"undefined"!=typeof i&&(jQuery(this).find(".um-slider").slider("option","values",i),jQuery(this).find(".um_range_min").val(i[0]),jQuery(this).find(".um_range_max").val(i[1]),jQuery(this).find(".um-slider-range").html(jQuery(this).find(".um-slider").slider("values",0)+" - "+jQuery(this).find(".um-slider").slider("values",1)+" y.o"))}}),e.find(".um-members-filter-tag").remove();var m=wp.template("um-members-filtered-line");e.find(".um-filtered-line").prepend(m({filters:a})),a.length>0?e.find(".um-filtered-line").show():e.find(".um-filtered-line").hide()}function um_members_show_preloader(e){e.find(".um-members-overlay").show()}function um_members_hide_preloader(e){e.find(".um-members-overlay").hide()}function um_ajax_get_members(e){var r=um_members_parse_hash(e);r.args=um_members_args,jQuery.ajax({url:um_scripts.ajax_get_members,type:"post",data:r,success:function(r){um_members_set_last_data(e,r),um_build_template(e,r),um_members_hide_preloader(e);var a=wp.template("um-members-pagination");e.find(".um-members-pagination-box").html(a(r.data)),e.data("total_pages",r.data.pagi.total_pages),um_members_directory_busy[um_members_get_unique_id(e)]=!1},error:function(e){console.log(e)}})}function um_build_template(e,r){var a=um_members_get_layout(e),m=wp.template("um-member-"+a);e.find(".um-members, .um-members-list").remove(),e.find(".um-members-wrapper").prepend(m(r.data)),e.addClass("um-loaded"),e.find(".um-members").length&&(UM_Member_Grid(e.find(".um-members")),jQuery(window).trigger("resize")),jQuery(document).trigger("um_build_template",[e])}function um_members_create_hash_string(){var e=[];for(var r in um_members_hash_data)for(var a in um_members_hash_data[r])e.push(a+"_"+r+"="+um_members_hash_data[r][a]);return"#"+e.join("&")}function um_members_parse_hash(e){var r={},a=window.location.hash.substring(1,window.location.hash.length);if(""==a)return r;var m=um_members_get_unique_id(e),t=a.split("&");for(var s in t){var u=t[s].split("=");u[0].search(new RegExp("_"+m+"$","g"))!==-1&&(u[0]=u[0].replace(new RegExp("_"+m+"$","g"),""),u[1].search(new RegExp(",","g"))!==-1?r[u[0]]=u[1].split(","):r[u[0]]=u[1])}return r}function um_members_set_hash(e){um_members_hash_data[um_members_get_unique_id(e)]=um_members_parse_hash(e)}function um_members_clear_hash(e){jQuery.each(um_members_hash_data,function(e){jQuery('.um-directory[data-unique_id="'+e+'"]').length?jQuery.each(um_members_hash_data[e],function(r){""==um_members_hash_data[e][r]&&delete um_members_hash_data[e][r]}):delete um_members_hash_data[e]}),e&&(unique_table=!1,window.location.hash=um_members_create_hash_string())}function um_members_directory_loop(){jQuery(".um-directory").each(function(){return um_members_directory_busy[um_members_get_unique_id(jQuery(this))]=!0,um_members_set_layout(jQuery(this),jQuery(this).data("view_type")),um_members_set_hash(jQuery(this)),um_members_set_search(jQuery(this)),um_members_set_sorting(jQuery(this)),um_members_set_filters(jQuery(this)),"1"!=jQuery(this).data("only_search")||um_members_hash_data[um_members_get_unique_id(jQuery(this))].hasOwnProperty("general_search")?(um_members_show_preloader(jQuery(this)),void um_ajax_get_members(jQuery(this))):(um_members_hide_preloader(jQuery(this)),um_members_directory_busy[um_members_get_unique_id(jQuery(this))]=!1,!1)})}var um_members_layout=[],um_members_last_data=[],um_members_hash_data={},um_members_directory_busy=[];jQuery(document).ready(function(){jQuery(document).on("click",".um-member-directory-view-type-a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var a=um_members_get_layout(r);a="grid"==a?"list":"grid",um_members_set_layout(r,a);var m="list"==a?"um-faicon-list":"um-faicon-th";r.find(".um-member-directory-view-type-a i").attr("class",m);var t="list"==a?"Change to Grid":"Change to List";r.find(".um-member-directory-view-type-a").attr("original-title",t),r.find(".um-member-directory-view-type-a").tipsy("hide").tipsy("show");var s=um_members_get_last_data(r);"undefined"!=typeof s?um_build_template(r,s):(um_members_show_preloader(r),um_ajax_get_members(r))}),jQuery(document).on("click",".um-directory .pagi:not(.current)",function(e){if(e.preventDefault(),!jQuery(this).hasClass("disabled")){var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var a;return a="first"==jQuery(this).data("page")?1:"prev"==jQuery(this).data("page")?1*r.data("page")-1:"next"==jQuery(this).data("page")?1*r.data("page")+1:"last"==jQuery(this).data("page")?r.data("total_pages"):jQuery(this).data("page"),1==a?(r.find('.pagi[data-page="first"], .pagi[data-page="prev"]').addClass("disabled"),r.find('.pagi[data-page="prev"], .pagi[data-page="last"]').removeClass("disabled")):a==r.data("total_pages")?(r.find('.pagi[data-page="prev"], .pagi[data-page="last"]').addClass("disabled"),r.find('.pagi[data-page="first"], .pagi[data-page="prev"]').removeClass("disabled")):(r.find('.pagi[data-page="prev"], .pagi[data-page="last"]').removeClass("disabled"),r.find('.pagi[data-page="first"], .pagi[data-page="prev"]').removeClass("disabled")),r.find(".pagi").removeClass("current"),r.find('.pagi[data-page="'+a+'"]').addClass("current"),um_members_set_page(r,a),um_members_hash_data[um_members_get_unique_id(r)].page=a,window.location.hash=um_members_create_hash_string(),!1}}),jQuery(document).on("change",".um-directory .um-members-pagi-dropdown",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var a=jQuery(this).val();return r.find(".pagi").removeClass("current"),r.find('.pagi[data-page="'+a+'"]').addClass("current"),um_members_set_page(r,a),um_members_hash_data[um_members_get_unique_id(r)].page=a,window.location.hash=um_members_create_hash_string(),!1}),jQuery(document).on("click",".um-do-search",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var a=um_members_get_unique_id(r);return um_members_hash_data[a].general_search=r.find(".um-search-line").val(),um_members_hash_data[a].page=1,um_members_clear_hash(),window.location.hash=um_members_create_hash_string(),!1}),jQuery(document).on("keypress",".um-search-line",function(e){if("13"==e.which){var r=jQuery(this).parents(".um-directory");r.find(".um-do-search").trigger("click")}}),jQuery(".um-member-directory-filters").click(function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory").find(".um-search");r.is(":visible")?r.slideUp(750):r.slideDown(750)}),jQuery(".um-close-filter").click(function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory").find(".um-search");r.slideUp(750)}),jQuery(document).on("change",".um-search-filter select",function(e){if(e.preventDefault(),""==jQuery(this).val())return!1;var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var a=um_members_get_unique_id(r),m=um_members_hash_data[a][jQuery(this).prop("name")];return"undefined"==typeof m?m=[]:"string"==typeof m&&(m=[m]),-1==jQuery.inArray(jQuery(this).val(),m)&&(m.push(jQuery(this).val()),um_members_hash_data[a][jQuery(this).prop("name")]=m,um_members_hash_data[a].page=1,um_members_clear_hash(),window.location.hash=um_members_create_hash_string()),jQuery(this).val("").trigger("change"),!1}),jQuery(document).on("click",".um-members-filter-remove",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var a=um_members_get_unique_id(r),m=jQuery(this).data("value");return"string"==typeof um_members_hash_data[a][jQuery(this).data("name")]&&(um_members_hash_data[a][jQuery(this).data("name")]=[um_members_hash_data[a][jQuery(this).data("name")]]),um_members_hash_data[a][jQuery(this).data("name")]=jQuery.grep(um_members_hash_data[a][jQuery(this).data("name")],function(e){return e!=m}),um_members_hash_data[a].page=1,um_members_clear_hash(),r.find(".um-members-filter-tag").remove(),window.location.hash=um_members_create_hash_string(),!1}),jQuery(document).on("click",".um-clear-filters-a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var a=um_members_get_unique_id(r);return r.find(".um-members-filter-remove").each(function(){var e=jQuery(this).data("value");"string"==typeof um_members_hash_data[a][jQuery(this).data("name")]&&(um_members_hash_data[a][jQuery(this).data("name")]=[um_members_hash_data[a][jQuery(this).data("name")]]),um_members_hash_data[a][jQuery(this).data("name")]=jQuery.grep(um_members_hash_data[a][jQuery(this).data("name")],function(r){return r!=e})}),um_members_hash_data[a].page=1,r.find(".um-members-filter-tag").remove(),um_members_clear_hash(),window.location.hash=um_members_create_hash_string(),!1});var e=jQuery(".um-slider");jQuery(".um-slider").slider({range:!0,min:parseInt(e.data("min")),max:parseInt(e.data("max")),values:[parseInt(e.data("min")),parseInt(e.data("max"))],create:function(e,r){console.log(r)},slide:function(e,r){jQuery(this).siblings(".um-slider-range").html(r.values[0]+" - "+r.values[1]+" y.o"),jQuery(this).siblings(".um_range_min").val(r.values[0]),jQuery(this).siblings(".um_range_max").val(r.values[1])},stop:function(e,r){var a=jQuery(this).parents(".um-directory"),m=um_members_get_unique_id(a);is_directory_busy(a)||(um_members_hash_data[m][jQuery(this).data("field_name")]=r.values,um_members_hash_data[m].page=1,um_members_clear_hash(),window.location.hash=um_members_create_hash_string())}}),jQuery(".um-slider-range").each(function(){jQuery(this).html(jQuery(this).siblings(".um-slider").slider("values",0)+" - "+jQuery(this).siblings(".um-slider").slider("values",1)+" y.o"),jQuery(this).siblings(".um_range_min").val(jQuery(this).siblings(".um-slider").slider("values",0)),jQuery(this).siblings(".um_range_max").val(jQuery(this).siblings(".um-slider").slider("values",1))}),jQuery(document).on("change",".um-member-directory-sorting-options",function(e){var r=jQuery(this).parents(".um-directory");if(is_directory_busy(r))return!1;var a=um_members_get_unique_id(r);return um_members_hash_data[a].sorting=jQuery(this).val(),um_members_hash_data[a].page=1,window.location.hash=um_members_create_hash_string(),!1}),jQuery(document).on("click",".um-member-more a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory"),a=jQuery(this).parents(".um-member");a.find(".um-member-more").hide(),a.find(".um-member-meta").slideDown(function(){a.find(".um-member-less").fadeIn(),r.find(".um-members").length&&UM_Member_Grid(r.find(".um-members"))}),setTimeout(function(){r.find(".um-members").length&&UM_Member_Grid(r.find(".um-members"))},100)}),jQuery(document).on("click",".um-member-less a",function(e){e.preventDefault();var r=jQuery(this).parents(".um-directory"),a=jQuery(this).parents(".um-member");a.find(".um-member-less").hide(),a.find(".um-member-meta").slideUp(function(){a.find(".um-member-more").fadeIn(),r.find(".um-members").length&&UM_Member_Grid(r.find(".um-members"))})}),window.addEventListener("popstate",function(e){um_members_directory_loop()}),um_members_directory_loop()});