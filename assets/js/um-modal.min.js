function um_remove_modal(){jQuery("img.cropper-hidden").cropper("destroy"),jQuery("body,html,textarea").css("overflow","auto"),jQuery(document).unbind("touchmove"),jQuery('.um-modal div[id^="um_"]').hide().appendTo("body"),jQuery(".um-modal,.um-modal-overlay").remove()}function um_modal_responsive(){var e,a=jQuery(".um-modal:visible"),i=jQuery(".um-modal-body.photo:visible");if(i.length){a.removeClass("uimob340"),a.removeClass("uimob500");var t=jQuery(".um-modal-photo img"),r=jQuery(window).width()-60,u=jQuery(window).height()-.25*jQuery(window).height();t.css({opacity:0}),t.css({"max-width":r}),t.css({"max-height":u}),jQuery(".um-modal").css({width:t.width(),"margin-left":"-"+t.width()/2+"px"}),t.animate({opacity:1},1e3),e=(jQuery(window).height()-a.innerHeight())/2+"px",a.animate({bottom:e},300)}else if(a.length){var d=jQuery(window).width();a.removeClass("uimob340"),a.removeClass("uimob500"),d<=340?(a.addClass("uimob340"),e=0):d<=500?(a.addClass("uimob500"),e=0):d<=800?e=(jQuery(window).height()-a.innerHeight())/2+"px":d<=960?e=(jQuery(window).height()-a.innerHeight())/2+"px":d>960&&(e=(jQuery(window).height()-a.innerHeight())/2+"px"),jQuery(document).trigger("um_after_modal_responsive_event"),a.animate({bottom:e},300)}}function um_new_modal(e,a,i,t){var r=jQuery("body").find(".um-modal-overlay");if(0==r.length)if(jQuery(document).trigger("um_before_new_modal_event"),jQuery(".tipsy").hide(),jQuery("body,html,textarea").css("overflow","hidden"),jQuery(document).bind("touchmove",function(e){e.preventDefault()}),jQuery(".um-modal").on("touchmove",function(e){e.stopPropagation()}),i?jQuery("body").append('<div class="um-modal-overlay"></div><div class="um-modal is-photo"></div>'):jQuery("body").append('<div class="um-modal-overlay"></div><div class="um-modal no-photo"></div>'),jQuery("#"+e).prependTo(".um-modal"),i){jQuery(".um-modal").find(".um-modal-photo").html("<img />");var u=jQuery(".um-modal-photo img"),d=jQuery(window).width()-60,o=jQuery(window).height()-.25*jQuery(window).height();u.attr("src",t),u.load(function(){jQuery("#"+e).show(),jQuery(".um-modal").show(),u.css({opacity:0}),u.css({"max-width":d}),u.css({"max-height":o}),jQuery(".um-modal").css({width:u.width(),"margin-left":"-"+u.width()/2+"px"}),u.animate({opacity:1},1e3),um_modal_responsive()})}else{jQuery("#"+e).show(),jQuery(".um-modal").show();var m=jQuery(".um-modal:visible");m.addClass(a),jQuery(document).trigger("um_after_new_modal_nophoto_event",[m]),um_modal_responsive()}}jQuery(document).ready(function(){jQuery(document).on("click",".um-popup-overlay",function(){remove_Modal()}),jQuery(document).on("click",'.um-modal-overlay, a[data-action="um_remove_modal"]',function(){um_remove_modal()}),jQuery(document).on("click",'a[data-modal^="um_"], span[data-modal^="um_"], .um-modal a',function(e){return e.preventDefault(),!1}),jQuery(document).on("click",".um-modal .um-single-file-preview a.cancel",function(e){e.preventDefault();var a=jQuery(this).parents(".um-modal-body"),i=jQuery(this).parents(".um-modal-body").find(".um-single-fileinfo a").attr("href");return a.find(".um-single-file-preview").hide(),a.find(".ajax-upload-dragdrop").show(),a.find(".um-modal-btn.um-finish-upload").addClass("disabled"),um_modal_responsive(),wp.ajax.send("um_remove_file",{data:{src:i,nonce:um_scripts.nonce}}),!1}),jQuery(document).on("click",".um-modal .um-single-image-preview a.cancel",function(e){e.preventDefault();var a=jQuery(this).parents(".um-modal-body"),i=jQuery(this).parents(".um-modal-body").find(".um-single-image-preview img").attr("src");return jQuery("img.cropper-hidden").cropper("destroy"),a.find(".um-single-image-preview img").attr("src",""),a.find(".um-single-image-preview").hide(),a.find(".ajax-upload-dragdrop").show(),a.find(".um-modal-btn.um-finish-upload").addClass("disabled"),um_modal_responsive(),wp.ajax.send("um_remove_file",{data:{src:i,nonce:um_scripts.nonce}}),!1}),jQuery(document).on("click",".um-finish-upload.file:not(.disabled)",function(){var e=jQuery(this).attr("data-key"),a=jQuery(this).parents(".um-modal-body").find(".um-single-file-preview").html();um_remove_modal(),jQuery(".um-single-file-preview[data-key="+e+"]").fadeIn().html(a),jQuery(".um-single-file-preview[data-key="+e+"]").parents(".um-field").find(".um-btn-auto-width").html(jQuery(this).attr("data-change")),jQuery(".um-single-file-preview[data-key="+e+"]").parents(".um-field").find('input[type="hidden"]').val(jQuery(".um-single-file-preview[data-key="+e+"]").parents(".um-field").find(".um-single-fileinfo a").attr("href"))}),jQuery(document).on("click",".um-finish-upload.image:not(.disabled)",function(){var e=jQuery(this),a=jQuery(this).attr("data-key"),i=jQuery(this).parents(".um-modal-body").find(".um-single-image-preview"),t=i.find("img").attr("src"),r=i.attr("data-coord"),u=i.find("img").data("file"),o=0;jQuery(this).parents("#um_upload_single").attr("data-user_id")&&(o=jQuery(this).parents("#um_upload_single").attr("data-user_id")),r?(jQuery(this).html(jQuery(this).attr("data-processing")).addClass("disabled"),wp.ajax.send("um_resize_image",{data:{src:t,coord:r,user_id:o,key:a,nonce:um_scripts.nonce},success:function(i){d=new Date,"profile_photo"==a&&jQuery(".um-profile-photo-img img").attr("src",i.image.source_url+"?"+d.getTime()),"cover_photo"==a&&(jQuery(".um-cover-e").empty().html('<img src="'+i.image.source_url+"?"+d.getTime()+'" alt="" />'),jQuery(".um").hasClass("um-editing")&&jQuery(".um-cover-overlay").show()),jQuery(".um-single-image-preview[data-key="+a+"]").fadeIn().find("img").attr("src",i.image.source_url+"?"+d.getTime()),um_remove_modal(),jQuery(".um-single-image-preview[data-key="+a+"]").parents(".um-field").find(".um-btn-auto-width").html(e.attr("data-change")),jQuery(".um-single-image-preview[data-key="+a+"]").parents(".um-field").find('input[type="hidden"]').val(i.image.filename),console.log(i)},error:function(e){}})):(d=new Date,jQuery(".um-single-image-preview[data-key="+a+"]").fadeIn().find("img").attr("src",t+"?"+d.getTime()),um_remove_modal(),jQuery(".um-single-image-preview[data-key="+a+"]").parents(".um-field").find(".um-btn-auto-width").html(e.attr("data-change")),jQuery(".um-single-image-preview[data-key="+a+"]").parents(".um-field").find('input[type="hidden"]').val(u))}),jQuery(document).on("click",'a[data-modal^="um_"], span[data-modal^="um_"]',function(e){var a=jQuery(this).attr("data-modal"),i="normal";jQuery(this).data("modal-size")&&(i=jQuery(this).data("modal-size")),jQuery(this).data("modal-copy")?(jQuery("#"+a).html(jQuery(this).parents(".um-field").find(".um-modal-hidden-content").html()),jQuery(this).parents(".um-profile-photo").attr("data-user_id")&&jQuery("#"+a).attr("data-user_id",jQuery(this).parents(".um-profile-photo").attr("data-user_id")),jQuery(this).parents(".um-cover").attr("data-ratio")&&jQuery("#"+a).attr("data-ratio",jQuery(this).parents(".um-cover").attr("data-ratio")),jQuery(this).parents(".um-cover").attr("data-user_id")&&jQuery("#"+a).attr("data-user_id",jQuery(this).parents(".um-cover").attr("data-user_id")),jQuery("input[type=hidden][name='user_id']").length>0&&jQuery("#"+a).attr("data-user_id",jQuery("input[type=hidden][name='user_id']").val()),um_new_modal(a,i)):um_new_modal(a,i)}),jQuery(document).on("um_responsive_event",um_modal_responsive)});